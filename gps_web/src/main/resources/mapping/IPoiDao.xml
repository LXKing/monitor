<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mmp.gps.monitor.dao.baseinfo.poi.IPoiDao">
    <select id="queryPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE COMPANYID = #{param1}
          AND NAME LIKE CONCAT('%', #{param2}, '%')
    </select>
    <select id="queryPageDetail" resultType="mmp.gps.monitor.dao.baseinfo.poi.PoiInfo">
        SELECT
            ID,
            NAME,
            TYPE,
            LAT,
            LNG,
            REMARK
        FROM point_of_interest
        WHERE COMPANYID = #{param1}
          AND NAME
            LIKE
              CONCAT('%', #{param2}, '%')
        ORDER BY NAME
                 LIMIT #{param3}, #{param4}
    </select>
    <select id="searchPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE COMPANYID = #{param1}
          AND NAME LIKE CONCAT('%', #{param2}, '%')
    </select>
    <select id="searchPageDetail" resultType="mmp.gps.monitor.dao.baseinfo.poi.PoiInfo">
        SELECT
            ID,
            NAME,
            TYPE,
            LAT,
            LNG,
            REMARK
        FROM point_of_interest
        WHERE COMPANYID = #{param1}
          AND NAME
            LIKE
              CONCAT('%', #{param2}, '%')
        ORDER BY NAME
                 LIMIT #{param3}, #{param4}
    </select>
    <select id="fetchInfo" resultType="mmp.gps.monitor.dao.baseinfo.poi.PoiInfo">
        SELECT
            ID,
            NAME,
            TYPE,
            LAT,
            LNG,
            REMARK
        FROM point_of_interest
        WHERE ID = #{param1}
            LIMIT 1
    </select>
    <insert id="create" parameterType="mmp.gps.monitor.dao.baseinfo.poi.Poi">
        INSERT INTO point_of_interest (COMPANYID,
                                       NAME, TYPE, LAT, LNG, REMARK)
        VALUES (#{companyId}, #{name}, #{type},
                #{lat},
                #{lng}, #{remark})
    </insert>
    <update id="update" parameterType="mmp.gps.monitor.dao.baseinfo.poi.Poi">
        UPDATE point_of_interest
        SET
            COMPANYID = #{companyId},
            NAME      = #{name},
            TYPE      = #{type},
            LAT       = #{lat},
            LNG       = #{lng},
            REMARK    = #{remark}
        WHERE ID = #{id}
          AND
            EDITTIME = #{editTime}
    </update>
    <select id="fetch" resultType="mmp.gps.monitor.dao.baseinfo.poi.Poi">
        SELECT
            ID,
            COMPANYID,
            NAME,
            TYPE,
            LAT,
            LNG,
            REMARK,
            EDITTIME
        FROM point_of_interest
        WHERE ID = #{param1}
            LIMIT 1
    </select>
    <delete id="delete">
        DELETE
        FROM point_of_interest
        WHERE ID = #{param1}
            LIMIT 1
    </delete>
    <select id="existOutId" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE
            NAME = #{param1}
          AND COMPANYID = #{param2}
          AND ID != #{param3}
            LIMIT 1
    </select>
    <select id="exist" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE
            NAME = #{param1}
          AND COMPANYID = #{param2}
            LIMIT 1
    </select>
</mapper>
