<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mmp.gps.monitor.dao.baseinfo.circleArea.ICircleAreaDao">
    <select id="queryPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM
            circle_region
        WHERE COMPANYID = #{param1}
          AND NAME LIKE CONCAT('%', #{param2}, '%')
    </select>
    <select id="queryPageDetail" resultType="mmp.gps.monitor.dao.baseinfo.circleArea.CircleAreaInfo">
        SELECT
            ID,
            NAME,
            DEVICECATCH,
            LAT,
            LNG,
            RADIUS,
            REMARK
        FROM circle_region
        WHERE
            COMPANYID = #{param1}
          AND NAME LIKE CONCAT('%', #{param2}, '%')
        ORDER BY NAME
                 LIMIT #{param3}, #{param4}
    </select>
    <select id="searchPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM
            circle_region
        WHERE COMPANYID = #{param1}
          AND NAME LIKE
              CONCAT('%', #{param2}, '%')
    </select>
    <select id="searchPageDetail" resultType="mmp.gps.monitor.dao.baseinfo.circleArea.CircleAreaInfo">
        SELECT
            ID,
            NAME,
            DEVICECATCH,
            LAT,
            LNG,
            RADIUS,
            REMARK
        FROM circle_region
        WHERE
            COMPANYID = #{param1}
          AND NAME LIKE CONCAT('%', #{param2}, '%')
        ORDER BY NAME
                 LIMIT #{param3}, #{param4}
    </select>

    <insert id="create" parameterType="mmp.gps.monitor.dao.baseinfo.circleArea.CircleArea">
        INSERT INTO circle_region (COMPANYID,
                                   NAME, DEVICECATCH, FLAG, LAT, LNG, RADIUS,
                                   MAXSPEED, OVERSPEEDSECONDS,
                                   STARTTIME, ENDTIME, REMARK)
        VALUES (#{companyId}, #{name},
                #{deviceCatch}, #{flag}, #{lat}, #{lng},
                #{radius}, #{maxSpeed},
                #{overspeedSeconds}, #{startTime},
                #{endTime}, #{remark})
    </insert>
    <update id="update" parameterType="mmp.gps.monitor.dao.baseinfo.circleArea.CircleArea">
        UPDATE circle_region
        SET
            COMPANYID        = #{companyId},
            NAME             = #{name},
            DEVICECATCH      = #{deviceCatch},
            FLAG             = #{flag},
            LAT              = #{lat},
            LNG              = #{lng},
            RADIUS           = #{radius},
            MAXSPEED         = #{maxSpeed},
            OVERSPEEDSECONDS = #{overspeedSeconds},
            STARTTIME        = #{startTime},
            ENDTIME          = #{endTime},
            REMARK           = #{remark},
            EDITTIME         = #{editTime}
        WHERE
            ID = #{id}
    </update>
    <select id="fetch" resultType="mmp.gps.monitor.dao.baseinfo.circleArea.CircleArea">
        SELECT
            ID,
            COMPANYID,
            NAME,
            DEVICECATCH,
            FLAG,
            LAT,
            LNG,
            RADIUS,
            MAXSPEED,
            OVERSPEEDSECONDS,
            STARTTIME,
            ENDTIME,
            REMARK,
            EDITTIME
        FROM circle_region
        WHERE ID = #{param1}
            LIMIT 1
    </select>
    <delete id="delete">
        DELETE
        FROM circle_region
        WHERE ID = #{param1}
            LIMIT 1
    </delete>
    <delete id="deleteAreaInDevice">
        DELETE
        FROM equipment_region
        WHERE AREAID = #{param1}
    </delete>
    <delete id="deleteAreaInMaplayer">
        DELETE
        FROM map_layer_cover
        WHERE AREAID = #{param1}
    </delete>
    <select id="existOutId" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM circle_region
        WHERE NAME = #{param1}
          AND COMPANYID = #{param2}
          AND ID != #{param3}
            LIMIT 1
    </select>
    <select id="exist" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM circle_region
        WHERE
            NAME = #{param1}
          AND COMPANYID = #{param2}
            LIMIT 1
    </select>
</mapper>
