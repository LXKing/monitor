<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.rayton.gps.dao.baseinfo.circleArea.ICircleAreaDao">
    <select id="queryPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM
        circle
        WHERE COMPANYID = #{0} AND NAME LIKE CONCAT('%', #{1}, '%')
    </select>
    <select id="queryPageDetail" resultType="com.rayton.gps.dao.baseinfo.circleArea.CircleAreaInfo">
        SELECT
        ID,
        NAME,
        DEVICECATCH,
        LAT,
        LNG,
        RADIUS,
        REMARK
        FROM circle
        WHERE
        COMPANYID = #{0}
        AND NAME LIKE CONCAT('%', #{1}, '%')
        ORDER BY NAME
        LIMIT #{2}, #{3}
    </select>
    <select id="searchPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM
        circle
        WHERE COMPANYID = #{0} AND NAME LIKE
        CONCAT('%', #{1}, '%')
    </select>
    <select id="searchPageDetail" resultType="com.rayton.gps.dao.baseinfo.circleArea.CircleAreaInfo">
        SELECT
        ID,
        NAME,
        DEVICECATCH,
        LAT,
        LNG,
        RADIUS,
        REMARK
        FROM circle
        WHERE
        COMPANYID = #{0}
        AND NAME LIKE CONCAT('%', #{1}, '%')
        ORDER BY NAME
        LIMIT #{2}, #{3}
    </select>

    <insert id="create" parameterType="com.rayton.gps.dao.baseinfo.circleArea.CircleArea">
        INSERT INTO circle (COMPANYID,
        NAME, DEVICECATCH, FLAG, LAT, LNG, RADIUS,
        MAXSPEED, OVERSPEEDSECONDS,
        STARTTIME, ENDTIME, REMARK) VALUES (#{companyId}, #{name},
        #{deviceCatch}, #{flag}, #{lat}, #{lng},
        #{radius}, #{maxSpeed},
        #{overspeedSeconds}, #{startTime},
        #{endTime}, #{remark})
    </insert>
    <update id="update" parameterType="com.rayton.gps.dao.baseinfo.circleArea.CircleArea">
        UPDATE circle
        SET
        COMPANYID = #{companyId}, NAME = #{name}, DEVICECATCH = #{deviceCatch},
        FLAG = #{flag}, LAT = #{lat}, LNG = #{lng}, RADIUS = #{radius},
        MAXSPEED = #{maxSpeed}, OVERSPEEDSECONDS = #{overspeedSeconds},
        STARTTIME = #{startTime}, ENDTIME = #{endTime}, REMARK = #{remark}
        WHERE
        ID = #{id} AND EDITTIME = #{editTime}
    </update>
    <select id="fetch" resultType="com.rayton.gps.dao.baseinfo.circleArea.CircleArea">
        SELECT
        ID,
        COMPANYID,
        NAME,
        DEVICECATCH,
        FLAG,
        LAT,
        LNG,
        RADIUS,
        MAXSPEED,
        OVERSPEEDSECONDS,
        STARTTIME,
        ENDTIME,
        REMARK,
        EDITTIME
        FROM circle
        WHERE ID = #{0}
        LIMIT 1
    </select>
    <delete id="delete">
        DELETE FROM circle
        WHERE ID = #{0}
        LIMIT 1
    </delete>
    <delete id="deleteAreaInDevice">
        DELETE FROM areaindevice
        WHERE AREAID = #{0}
    </delete>
    <delete id="deleteAreaInMaplayer">
        DELETE FROM areainmaplayer
        WHERE AREAID = #{0}
    </delete>
    <select id="existOutId" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM circle
        WHERE NAME = #{0} AND COMPANYID = #{1} AND ID != #{2}
        LIMIT 1
    </select>
    <select id="exist" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM circle
        WHERE
        NAME = #{0} AND COMPANYID = #{1}
        LIMIT 1
    </select>
</mapper>