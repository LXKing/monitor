<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.rayton.gps.dao.baseinfo.poi.IPoiDao">
    <select id="queryPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE COMPANYID = #{0} AND NAME LIKE CONCAT('%', #{1}, '%')
    </select>
    <select id="queryPageDetail" resultType="com.rayton.gps.dao.baseinfo.poi.PoiInfo">
        SELECT
        ID,
        NAME,
        TYPE,
        LAT,
        LNG,
        REMARK
        FROM point_of_interest
        WHERE COMPANYID = #{0} AND NAME
        LIKE
        CONCAT('%', #{1}, '%')
        ORDER BY NAME
        LIMIT #{2}, #{3}
    </select>
    <select id="searchPageCount" resultType="java.lang.Integer">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE COMPANYID = #{0} AND NAME LIKE CONCAT('%', #{1}, '%')
    </select>
    <select id="searchPageDetail" resultType="com.rayton.gps.dao.baseinfo.poi.PoiInfo">
        SELECT
        ID,
        NAME,
        TYPE,
        LAT,
        LNG,
        REMARK
        FROM point_of_interest
        WHERE COMPANYID = #{0} AND NAME
        LIKE
        CONCAT('%', #{1}, '%')
        ORDER BY NAME
        LIMIT #{2}, #{3}
    </select>
    <select id="fetchInfo" resultType="com.rayton.gps.dao.baseinfo.poi.PoiInfo">
        SELECT
        ID,
        NAME,
        TYPE,
        LAT,
        LNG,
        REMARK
        FROM point_of_interest
        WHERE ID = #{0}
        LIMIT 1
    </select>
    <insert id="create" parameterType="com.rayton.gps.dao.baseinfo.poi.Poi">
        INSERT INTO point_of_interest (COMPANYID,
        NAME, TYPE, LAT, LNG, REMARK) VALUES (#{companyId}, #{name}, #{type},
        #{lat},
        #{lng}, #{remark})
    </insert>
    <update id="update" parameterType="com.rayton.gps.dao.baseinfo.poi.Poi">
        UPDATE point_of_interest
        SET
        COMPANYID = #{companyId},
        NAME = #{name}, TYPE = #{type}, LAT = #{lat},
        LNG = #{lng}, REMARK = #{remark}
        WHERE ID = #{id} AND
        EDITTIME = #{editTime}
    </update>
    <select id="fetch" resultType="com.rayton.gps.dao.baseinfo.poi.Poi">
        SELECT
        ID,
        COMPANYID,
        NAME,
        TYPE,
        LAT,
        LNG,
        REMARK,
        EDITTIME
        FROM point_of_interest
        WHERE ID = #{0}
        LIMIT 1
    </select>
    <delete id="delete">
        DELETE FROM point_of_interest
        WHERE ID = #{0}
        LIMIT 1
    </delete>
    <select id="existOutId" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE
        NAME = #{0} AND COMPANYID = #{1} AND ID != #{2}
        LIMIT 1
    </select>
    <select id="exist" resultType="java.lang.Boolean">
        SELECT COUNT(1)
        FROM point_of_interest
        WHERE
        NAME = #{0} AND COMPANYID = #{1}
        LIMIT 1
    </select>
</mapper>