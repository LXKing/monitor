<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>基础信息</title>

    <link th:href="@{/static/lib/layui/css/layui.css}"
          rel="stylesheet" type="text/css"/>

</head>


<script th:src="@{/static/lib/layui/layui.all.js}"></script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script th:src="@{/static/lib/template-web.js}"></script>


<script id="nav" type="text/html">
    <ul class="layui-nav layui-nav-tree" lay-filter="test">
        {{each data as value }} {{ if value.pid==null }}
        <li class="layui-nav-item layui-nav-itemed">
            <a class="" href="javascript:;">{{ value.text }}

                <span class="layui-nav-more"></span>

            </a> {{set temp = value.id}}
            <dl class="layui-nav-child">
                {{each data as val}} {{ if val.pid== temp }}
                <dd><a href="javascript:;" onclick="nav_to('{{val.url}}')">{{ val.text }}</a></dd>
                {{/if}} {{/each}}
            </dl>
        </li>
        {{/if}} {{/each}}
    </ul>
</script>



<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>

<script>
    layui.use('upload', function () {
        const upload = layui.upload;

        // 执行实例
        const uploadInst = upload.render({
            elem: '#theUpload' //绑定元素
            , url: '/upload/' //上传接口
            , done: function (res) {
                //上传完毕回调
            }
            , error: function () {
                //请求异常回调
            }
            //,accept: 'file' //允许上传的文件类型
            //,size: 50 //最大允许上传的文件大小
        });
    });
</script>

<!--日期-->
<script>

    laydate.render({
        elem: '#theDate' //指定元素
        , done: function (value, date, endDate) {
            console.log(value); //得到日期生成的值，如：2017-08-18
            console.log(date); //得到日期时间对象：{year: 2017, month: 8, date: 18, hours: 0, minutes: 0, seconds: 0}
            console.log(endDate); //得结束的日期时间对象，开启范围选择（range: true）才会返回。对象成员同上。
        }
    });
</script>


<script>
    //由于模块都一次性加载，因此不用执行 layui.use() 来加载对应模块，直接使用即可：
    (function () {

        var table = layui.table;

        //第一个实例
        table.render({
            elem: '#theTable',
            height: 315,
            url: '/driver/query/',
            method: 'post',
            request: {
                filter: ''
            },
            page: true,
            cols: [
                [
                    {type: 'checkbox'},
                    //表头
                    {field: 'id', title: 'ID', sort: true},
                    {field: 'eDITTIME', title: 'eDITTIME', sort: true},
                    {fixed: 'right', align: 'center', toolbar: '#barDemo'}

                ]
            ]
        });

        //监听表格复选框选择
        table.on('checkbox(table)', function (obj) {
            console.log(obj);
        });

        //监听工具条
        table.on('tool(table)', function (obj) {
            var data = obj.data;
            if (obj.event === 'detail') {
                layer.msg('ID：' + data.id + ' 的查看操作');
            } else if (obj.event === 'del') {
                layer.confirm('真的删除行么', function (index) {
                    obj.del();
                    layer.close(index);
                });
            } else if (obj.event === 'edit') {
                layer.alert('编辑行：<br>' + JSON.stringify(data))
            }
        });

        var $ = layui.$, active = {
            getCheckData: function () { //获取选中数据
                var checkStatus = table.checkStatus('idTest')
                    , data = checkStatus.data;
                layer.alert(JSON.stringify(data));
            }
            , getCheckLength: function () { //获取选中数目
                var checkStatus = table.checkStatus('idTest')
                    , data = checkStatus.data;
                layer.msg('选中了：' + data.length + ' 个');
            }
            , isAll: function () { //验证是否全选
                var checkStatus = table.checkStatus('idTest');
                layer.msg(checkStatus.isAll ? '全选' : '未全选')
            }
        };

        $('.demoTable .layui-btn').on('click', function () {
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });

        // SEARCH
        var $ = layui.$, active = {
            reload: function () {
                var tableReload = $('#tableReload');

                //执行重载
                table.reload('testReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    , where: {
                        key: {
                            id: tableReload.val()
                        }
                    }
                });
            }
        };

        $('.demoTable .layui-btn').on('click', function () {
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });

    })();
</script>



<script>
    function nav_to(url) {
        console.log(url);
    }

    (function () {

        $.ajax({
            url: "/baseinfo/menus", success: function (res) {

                document.getElementById('view').innerHTML = template("nav", {
                    data: res
                });

                // const data = {
                //     data: res
                // };
                // let html = template("nav", data);
                // // console.log(html);
                // var view = document.getElementById('view');
                // view.innerHTML = html;
            }
        });

    })();


</script>


<script>


    const mmp = "<div class=\"layui-tab layui-tab-card\">\n" +
        "  <ul class=\"layui-tab-title\">\n" +
        "    <li class=\"layui-this\">网站设置</li>\n" +
        "    <li>用户管理</li>\n" +
        "    <li>权限分配</li>\n" +
        "    <li>商品管理</li>\n" +
        "    <li>订单管理</li>\n" +
        "  </ul>\n" +
        "  <div class=\"layui-tab-content\" style=\"height: 100px;\">\n" +
        "    <div class=\"layui-tab-item layui-show\">1</div>\n" +
        "    <div class=\"layui-tab-item\">2</div>\n" +
        "    <div class=\"layui-tab-item\">3</div>\n" +
        "    <div class=\"layui-tab-item\">4</div>\n" +
        "    <div class=\"layui-tab-item\">5</div>\n" +
        "    <div class=\"layui-tab-item\">6</div>\n" +
        "  </div>\n" +
        "</div>\n";

    (function () {
        //多窗口模式，层叠置顶
        layer.open({
            type: 1,
            title: '当你选择该窗体时，即会在最顶端'
            , area: ['390px', '330px']
            , shade: 0
            , offset: [ //为了演示，随机坐标
                 ($(window).height() /2)
                ,  ($(window).width()  /2)
            ]
            , maxmin: true
            , content: mmp
            , btn: ['继续弹出', '全部关闭'] //只是为了演示
            , yes: function () {
                $(that).click(); //此处只是为了演示，实际使用可以剔除
            }
            , btn2: function () {
                layer.closeAll();
            }

            , zIndex: layer.zIndex //重点1
            , success: function (layero) {
                layer.setTop(layero); //重点2
            }
        });
    })();
</script>
</html>