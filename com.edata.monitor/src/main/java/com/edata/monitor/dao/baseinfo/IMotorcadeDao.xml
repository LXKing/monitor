<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.edata.monitor.dao.baseinfo.IMotorcadeDao">
	<select id="list" resultType="com.edata.monitor.dao.baseinfo.MotorcadeDto">
		SELECT ID, `TYPE`, NAME, LINKMAN,
		PHONE, PARENTVISIBLE, REMARK FROM
		motorcade WHERE COMPANYID=#{0}
	</select>
	<insert id="create" parameterType="com.edata.monitor.dao.baseinfo.MotorcadeDto">
		INSERT INTO motorcade (ID,
		COMPANYID, `TYPE`, NAME, LINKMAN, PHONE,
		PARENTVISIBLE, REMARK) VALUES
		(#{id}, #{companyId}, #{type}, #{name}, #{linkMan}, #{phone},
		#{parentVisible}, #{remark})
	</insert>
	<update id="update" parameterType="com.edata.monitor.dao.baseinfo.MotorcadeDto">
		UPDATE motorcade SET
		COMPANYID=#{companyId}, `TYPE`=#{type}, NAME=#{name},
		LINKMAN=#{linkMan}, PHONE=#{phone},
		PARENTVISIBLE=#{parentVisible},
		REMARK=#{remark} WHERE ID=#{id} AND EDITTIME=#{editTime} LIMIT 1
	</update>
	<delete id="delete">
		DELETE FROM motorcade WHERE ID=#{0} LIMIT 1
	</delete>
	<select id="fetch" resultType="com.edata.monitor.dao.baseinfo.MotorcadeDto">
		SELECT ID, COMPANYID, `TYPE`,
		NAME,
		LINKMAN, PHONE, PARENTVISIBLE, REMARK,
		EDITTIME FROM motorcade
		WHERE
		ID=#{0} LIMIT 1
	</select>
	<select id="exist" resultType="java.lang.Boolean">
		SELECT COUNT(1) FROM motorcade
		WHERE NAME=#{0} AND COMPANYID=#{0} LIMIT 1
	</select>
	<select id="existOutId" resultType="java.lang.Boolean">
		SELECT COUNT(1) FROM
		motorcade WHERE
		NAME=#{0} AND COMPANYID=#{1} AND ID != #{2} LIMIT 1
	</select>
	<select id="hasVehicle" resultType="java.lang.Boolean">
		SELECT COUNT(1) FROM vehicle
		WHERE MOTORCADEID=#{0} LIMIT 1
	</select>
</mapper>