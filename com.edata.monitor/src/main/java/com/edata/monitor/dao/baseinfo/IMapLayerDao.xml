<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.edata.monitor.dao.baseinfo.IMapLayerDao">
	<select id="query" resultType="com.edata.monitor.dao.baseinfo.MapLayerDto">
		SELECT ID, NAME, VISIBLE, REMARK
		FROM maplayer WHERE USERID=#{0} AND NAME LIKE
		CONCAT('%',#{1},'%')
	</select>
	<select id="getMapLayInfo" resultType="com.edata.monitor.dao.baseinfo.MapLayerDto">
		SELECT ID, NAME, VISIBLE,
		REMARK FROM maplayer WHERE ID=#{0}
	</select>
	<insert id="create" parameterType="com.edata.monitor.dao.baseinfo.MapLayerDto">
		INSERT INTO maplayer(ID,
		COMPANYID, USERID, NAME, VISIBLE, REMARK) VALUES
		(#{id}, #{companyId},
		#{userId}, #{name},
		#{visible}, #{remark})
	</insert>
	<select id="fetch" resultType="com.edata.monitor.dao.baseinfo.MapLayerDto">
		SELECT ID, COMPANYID, USERID,
		NAME,
		VISIBLE, REMARK, EDITTIME FROM maplayer
		WHERE ID=#{0} LIMIT 1
	</select>
	<update id="update" parameterType="com.edata.monitor.dao.baseinfo.MapLayerDto">
		UPDATE maplayer SET
		COMPANYID=#{companyId}, USERID=#{userId}, NAME=#{name},
		VISIBLE=#{visible}, REMARK=#{remark} WHERE
		ID=#{id} AND
		EDITTIME=#{editTime} LIMIT 1
	</update>
	<delete id="delete">
		DELETE FROM maplayer WHERE ID=#{0} LIMIT 1
	</delete>
	<delete id="deleteAreaInMaplayer">
		DELETE FROM areainmaplayer WHERE MAPLAYERID=#{0}
	</delete>
	<insert id="addAreas">
		REPLACE INTO areainmaplayer(MAPLAYERID, AREAID, AREATYPE) VALUES
		<foreach collection="list" item="item" separator=",">
			(#{item.key},#{item.value.key},#{item.value.value})
		</foreach>
	</insert>
	<delete id="removeArea">
		DELETE FROM areainmaplayer WHERE MAPLAYERID=#{0} AND
		AREAID=#{1} AND AREATYPE=#{2}
	</delete>
	<select id="getCircleAreas" resultType="java.lang.Long">
		SELECT AREAID FROM
		areainmaplayer WHERE MAPLAYERID=#{0} AND AREATYPE=1
	</select>
	<select id="getRectangleAreas" resultType="java.lang.Long">
		SELECT AREAID FROM
		areainmaplayer WHERE MAPLAYERID=#{0} AND AREATYPE=2
	</select>
	<select id="getPolygonAreas" resultType="java.lang.Long">
		SELECT AREAID FROM
		areainmaplayer WHERE
		MAPLAYERID=#{0} AND AREATYPE=3
	</select>
	<select id="getRouteAreas" resultType="java.lang.Long">
		SELECT AREAID FROM
		areainmaplayer WHERE
		MAPLAYERID=#{0} AND AREATYPE=4
	</select>
	<select id="getPois" resultType="java.lang.Long">
		SELECT AREAID FROM
		areainmaplayer WHERE
		MAPLAYERID=#{0} AND AREATYPE=100
	</select>
	<update id="setVisible">
		UPDATE maplayer SET VISIBLE=#{1} WHERE ID=#{0} LIMIT
		1
	</update>
</mapper>